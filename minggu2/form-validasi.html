<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Edit Data Aktivitas</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
</head>
<body class="bg-light d-flex justify-content-center align-items-center vh-100">

  <div class="container bg-white p-4 rounded shadow" style="max-width: 600px;">
    <!-- Notifikasi -->
    <div id="toastPesan" class="alert d-none text-white bg-danger mb-3" role="alert">
      <div class="d-flex justify-content-between">
        <span id="isiPesan">Pesan di sini</span>
        <button type="button" class="btn-close btn-close-white" onclick="sembunyikanToast()"></button>
      </div>
    </div>

    <h3 class="mb-3">Aktivitas Harian</h3>

    <!-- Form -->
    <form onsubmit="return prosesForm(event)">
      <div class="input-group mb-3">
        <input type="text" id="inputAktivitas" class="form-control" placeholder="Masukkan aktivitas">
        <button id="btnSubmit" class="btn btn-primary" type="submit">Tambah</button>
      </div>
    </form>

    <!-- Tabel -->
    <div class="table-responsive">
      <table class="table table-striped table-bordered align-middle text-center">
        <thead class="table-dark">
          <tr>
            <th>No</th>
            <th>Aktivitas</th>
            <th>Aksi</th>
          </tr>
        </thead>
        <tbody id="tabelAktivitas"></tbody>
      </table>
    </div>
  </div>

  <script>
    let daftarAktivitas = JSON.parse(localStorage.getItem("daftarAktivitas")) || [];
    let indeksEdit = -1; // -1 artinya bukan mode edit

    function tampilkanToast(pesan, tipe = "danger") {
      const toast = document.getElementById("toastPesan");
      const isi = document.getElementById("isiPesan");

      toast.className = `alert text-white bg-${tipe} mb-3`;
      isi.textContent = pesan;
      toast.classList.remove("d-none");

      setTimeout(() => toast.classList.add("d-none"), 3000);
    }

    function sembunyikanToast() {
      document.getElementById("toastPesan").classList.add("d-none");
    }

    function prosesForm(event) {
      event.preventDefault();
      const input = document.getElementById("inputAktivitas");
      const aktivitas = input.value.trim();

      if (aktivitas === "") {
        tampilkanToast("Aktivitas tidak boleh kosong!", "danger");
        return false;
      }

      if (indeksEdit === -1) {
        // Mode tambah
        daftarAktivitas.push(aktivitas);
        tampilkanToast("Aktivitas berhasil ditambahkan!", "success");
      } else {
        // Mode edit
        daftarAktivitas[indeksEdit] = aktivitas;
        tampilkanToast("Aktivitas berhasil diperbarui!", "success");
        indeksEdit = -1;
        document.getElementById("btnSubmit").textContent = "Tambah";
      }

      localStorage.setItem("daftarAktivitas", JSON.stringify(daftarAktivitas));
      input.value = "";
      input.focus();
      tampilkanData();

      return true;
    }

    function tampilkanData() {
  const tbody = document.getElementById("tabelAktivitas");
  tbody.innerHTML = "";

  daftarAktivitas.forEach((item, index) => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${index + 1}</td>
      <td>${item}</td>
      <td>
        <button class="btn btn-sm btn-warning me-1" onclick="editAktivitas(${index})">Edit</button>
        <button class="btn btn-sm btn-danger" onclick="hapusAktivitas(${index})">Hapus</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
}


    function editAktivitas(index) {
      document.getElementById("inputAktivitas").value = daftarAktivitas[index];
      indeksEdit = index;
      document.getElementById("btnSubmit").textContent = "Update";
    }

    function hapusAktivitas(index) {
      if (confirm("Yakin ingin menghapus aktivitas ini?")) {
        daftarAktivitas.splice(index, 1);
        localStorage.setItem("daftarAktivitas", JSON.stringify(daftarAktivitas));
        tampilkanToast("Aktivitas berhasil dihapus!", "success");
        tampilkanData();
      }
    }

    tampilkanData(); // tampilkan saat load
  </script>
</body>
</html>
